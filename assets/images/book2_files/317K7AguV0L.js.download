'use strict';mix_d("FeedbackAgentWidgetCards__submit-feedback-card:submit-feedback-card__SgknR9L-","exports tslib @c/aui-modal @c/browser-operations @c/remote-operations @c/scoped-dom @c/navigation @c/guard".split(" "),function(M,d,Y,N,Z,aa,ba,ca){function t(b){return b&&"object"===typeof b&&"default"in b?b:{"default":b}}function da(b){return d.__awaiter(this,void 0,void 0,function(){var a;return d.__generator(this,function(c){a=new URLSearchParams(b.searchParams);return[2,b.scheme+"://"+b.hostname+
b.path+"?"+a.toString()]})})}var O=t(Y),ea=t(N),fa=t(Z),x=t(aa),n=t(ba),u=t(ca),y;(function(b){b.inappropriateContentHandler="inappropriateContentHandler";b.formattingHandler="formattingHandler"})(y||(y={}));var P=y,z;(function(b){b.checkid_setup="checkid_setup";b.logout="logout"})(z||(z={}));var f;(function(b){b.ns="openid.ns";b.mode="openid.mode";b.assoc_handle="openid.assoc_handle";b.claimed_id="openid.claimed_id";b.identity="openid.identity";b.return_to="openid.return_to";b.pape_ns="openid.ns.pape";
b.pape_max_auth_age="openid.pape.max_auth_age";b.marketPlaceId="marketPlaceId";b.clientContext="clientContext";b.pageId="pageId";b.language_code="language";b.intercept="intercept"})(f||(f={}));var ha=function(b){function a(){var c=null!==b&&b.apply(this,arguments)||this;c.maxAuthAge=-1;return c}d.__extends(a,b);a.prototype.withEnablePasswordAssert=function(c){this.enablePasswordAssert=c;return this};a.prototype.withMaxAuthAge=function(c){this.maxAuthAge=c;return this};a.prototype.getPageSpecificParameters=
function(c){c=d.__assign({},c);this.enablePasswordAssert&&(c[f.claimed_id]=a.CONFIRM_CREDS_URI,c[f.identity]=a.CONFIRM_CREDS_URI);0<=this.maxAuthAge&&(c[f.pape_max_auth_age]=this.maxAuthAge.toString());return c};a.prototype.getPath=function(){return a.LOGIN_PATH};a.LOGIN_PATH="/ap/signin";a.CONFIRM_CREDS_URI="http://www.amazon.com/ap/specs/auth/confirm_credentials";return a}(function(){function b(){this.additionalParameters=Object.create(null)}b.prototype.withDomain=function(a){this.domain=a;return this};
b.prototype.withAssociationHandle=function(a){this.associationHandle=a;return this};b.prototype.withReturnToUrl=function(a){this.returnToUrl=a;return this};b.prototype.withMarketplaceId=function(a){a&&(this.marketplaceId=a);return this};b.prototype.withClientContext=function(a){this.clientContext=a;return this};b.prototype.withPageId=function(a){a&&(this.pageId=a);return this};b.prototype.withLanguage=function(a){a&&(this.language=a);return this};b.prototype.withParameters=function(a){a&&(this.additionalParameters=
Object.assign({},this.additionalParameters,a));return this};b.prototype.build=function(){this.validateRequiredParams();var a=this.getDefaultParameters(),c=this.getPageSpecificParameters(a);return this.buildUrl(this.getPath(),Object.assign({},a,c,this.additionalParameters))};b.prototype.validateRequiredParams=function(){if(!this.domain)throw Error("Required parameter domain is missing");if(!this.associationHandle)throw Error("Required parameter association handle is missing");if(!this.returnToUrl)throw Error("Required parameter return-to url is missing");
};b.prototype.getDefaultParameters=function(){var a={};a[f.assoc_handle]=this.associationHandle;a[f.mode]=z.checkid_setup;a[f.ns]=b.NS;a[f.claimed_id]=b.IDENTIFIER_SELECT;a[f.identity]=b.IDENTIFIER_SELECT;a[f.return_to]=this.returnToUrl;this.marketplaceId&&(a[f.marketPlaceId]=this.marketplaceId);this.clientContext&&(a[f.clientContext]=this.clientContext);this.pageId&&(a[f.pageId]=this.pageId);this.language&&(a[f.language_code]=this.language);return a};b.prototype.buildUrl=function(a,c){return d.__awaiter(this,
void 0,void 0,function(){return d.__generator(this,function(v){return[2,da({scheme:"https",path:a,searchParams:c,hostname:this.domain})]})})};b.IDENTIFIER_SELECT="http://specs.openid.net/auth/2.0/identifier_select";b.NS="http://specs.openid.net/auth/2.0";b.NS_PAPE="http://specs.openid.net/extensions/pape/1.0";return b}()),Q=[/[A-Za-z0-9\.\-_]+@[A-Za-z0-9\.\-_]+\.[A-Za-z]+/,/\d{4}[ \-]?\d{4}[ \-]?\d{4}[ \-]?\d{4}/,/\d{3}[ \-]?\d{2}[ \-]?\d{4}/,/(\(?\d{3}\)?)?[ \-\.]?\d{3}[ \-\.]?\d{4}/,/\d{3}\-\d{7}\-\d{7}/,
/\d{1,5}\s([\w\.\-]+\s){1,3}(st|ln|rd|ave|dr|pkwy|blvd|street|lane|road|avenue|drive|parkway|boulevard)\b/i,/\d{5}[ \-]?\d{4}/,/https?:\/\/[A-Za-z0-9\-_\.]/i],ia=function(b){for(var a=0;a<Q.length;a++)if(-1!==b.search(Q[a]))return!0;return!1},R=function(b){return d.__awaiter(this,void 0,void 0,function(){var a,c,v;return d.__generator(this,function(p){switch(p.label){case 0:return a="localhost"==n["default"].getLocation().hostname?"development.amazon.com":n["default"].getLocation().host,c="localhost"==
n["default"].getLocation().hostname?"https://development.amazon.com":n["default"].getLocation().href,[4,u["default"].promise((new ha).withDomain(a).withAssociationHandle(b).withReturnToUrl(c).build())];case 1:return v=p.sent(),n["default"].setLocation(v),[2]}})})};M._operationNames=["fetchModalContent","fetchContextData","postFeedbackData"];M.card=function(){return d.__awaiter(void 0,void 0,void 0,function(){function b(h,e){var g,A,B,C,D,E,F,G;return d.__awaiter(this,void 0,void 0,function(){var q,
k,S,T;return d.__generator(this,function(ja){"a-button-text"==(null===(g=h.target)||void 0===g?void 0:g.className)&&(q=null===(A=h.currentTarget)||void 0===A?void 0:A.querySelector(".a-dropdown-prompt"),k=null===(C=null===(B=h.currentTarget)||void 0===B?void 0:B.querySelector(".a-input-text-wrapper"))||void 0===C?void 0:C.querySelector("textarea"),(null===k||void 0===k?0:k.value)&&ia(null===k||void 0===k?void 0:k.value)?(null===(E=null===(D=h.currentTarget)||void 0===D?void 0:D.querySelector(".error-personal-information"))||
void 0===E?void 0:E.classList.remove("aok-hidden"),null===(G=null===(F=h.currentTarget)||void 0===F?void 0:F.querySelector(".limit-personal-information"))||void 0===G?void 0:G.classList.add("aok-hidden")):(null===q||void 0===q?0:q.innerHTML)&&(null===k||void 0===k?0:k.value)&&(S="localhost"==n["default"].getLocation().hostname?"https://development.amazon.com":n["default"].getLocation().href,T="localhost"==n["default"].getLocation().hostname?"https://development.amazon.com":n["default"].getLocation().origin,
a.postFeedbackData({asin:U+" "+V||" ",freeformText:k.value,issueSelected:null===q||void 0===q?void 0:q.innerHTML,referer:S,url:T,routingType:"formatting"==e?"ReportContentQuality":"ReportInappropriateContent"}).then(function(){var l,m=null===(l=h.currentTarget)||void 0===l?void 0:l.querySelector(".feedback-thankYouSection");null===m||void 0===m?void 0:m.classList.remove("aok-hidden")}).catch(function(){var l,m=null===(l=h.currentTarget)||void 0===l?void 0:l.querySelector(".feedback-errorSection");
null===m||void 0===m?void 0:m.classList.remove("aok-hidden")}).finally(function(){var l,m=null===(l=h.currentTarget)||void 0===l?void 0:l.querySelector(".feedback-entrySection");null===m||void 0===m?void 0:m.classList.add("aok-hidden")})));return[2]})})}var a,c,v,p,H,I,J,W,w,r,X,V,U,K,L;return d.__generator(this,function(h){switch(h.label){case 0:return a=fa["default"].setup(),c=ea["default"].setup(),v={a11yOpenMessage:""},p=O["default"].create("inappropriate-content-modal","._submit-feedback-card_style_inappropriateContentModalRoot__d_oz7.aok-hidden",
v),[4,u["default"].promise(a.fetchContextData({}))];case 1:return H=h.sent(),I=H.customerId,J=H.associationId,p.once("beforeShow",function(){a.fetchModalContent({modalType:"inappropriateContent"}).then(function(e){p.render(function(g){g.appendChild(e)})})}),c.define("openInappropriateContentModal","click",function(){return d.__awaiter(void 0,void 0,void 0,function(){return d.__generator(this,function(e){switch(e.label){case 0:return I?[3,2]:[4,u["default"].promise(R(J))];case 1:return e.sent(),[3,
3];case 2:p.show(),e.label=3;case 3:return[2]}})})}),c.attach("openInappropriateContentModal",x["default"].cardRoot.querySelector("._submit-feedback-card_style_inappropriateContentTrigger__13AAp")),W={a11yOpenMessage:""},w=O["default"].create("formatting-modal","._submit-feedback-card_style_formattingIssuesModalRoot__3y9Ee.aok-hidden",W),w.once("beforeShow",function(){a.fetchModalContent({modalType:"formatting"}).then(function(e){w.render(function(g){g.appendChild(e)})})}),r=null===(L=x["default"].cardRoot.querySelector(".asin"))||
void 0===L?void 0:L.classList[3],V=(X=null===r||void 0===r?void 0:r.split(":")[1])?X:"",U=null===r||void 0===r?void 0:r.split(":")[0],c.define("openFormattingModal","click",function(){return d.__awaiter(void 0,void 0,void 0,function(){return d.__generator(this,function(e){switch(e.label){case 0:return I?[3,2]:[4,u["default"].promise(R(J))];case 1:return e.sent(),[3,3];case 2:w.show(),e.label=3;case 3:return[2]}})})}),c.attach("openFormattingModal",x["default"].cardRoot.querySelector("._submit-feedback-card_style_formattingIssuesTrigger__1vfjh")),
K=N.setup().define,K(P.inappropriateContentHandler,"click",function(e){return d.__awaiter(void 0,void 0,void 0,function(){return d.__generator(this,function(g){switch(g.label){case 0:return[4,u["default"].promise(b(e,"inappropriateContent"))];case 1:return g.sent(),[2]}})})}),K(P.formattingHandler,"click",function(e){return d.__awaiter(void 0,void 0,void 0,function(){return d.__generator(this,function(g){switch(g.label){case 0:return[4,u["default"].promise(b(e,"formatting"))];case 1:return g.sent(),
[2]}})})}),[2]}})})}});
