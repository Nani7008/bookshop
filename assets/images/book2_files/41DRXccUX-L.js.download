(function(f){var e=window.AmazonUIPageJS||window.P,t=e._namespace||e.attributeErrors,x=t?t("DetailPageEbooksAssets",""):e;x.guardFatal?x.guardFatal(f)(x,window):x.execute(function(){f(x,window)})})(function(f,e,t){"use strict";f.when("A","jQuery","imageThumbNails","ready").execute(function(d,a,b){function c(){0<h.scrollLeft()&&(q=h.scrollLeft(),q>A?z=h.scrollLeft()-A:(z=0,setTimeout(function(){m.removeClass("enabled")},750)),u(),p.addClass("enabled"))}function v(){h.scrollLeft()+h.width()<r&&(C=r+
x-(h.scrollLeft()+h.width()),C>A?z=h.scrollLeft()+A:(z=h.scrollLeft()+C,setTimeout(function(){p.removeClass("enabled")},750)),u(),m.addClass("enabled"))}function u(){h.animate({scrollLeft:z},750)}function k(){var a=e.navigator.userAgent,b=a.indexOf("MSIE "),c=a.indexOf("Trident/"),a=a.indexOf("Edge/");return 0<b||0<c||0<a}var m=a("#thumbs-left"),p=a("#thumbs-right"),h=a(".thumbnail-container .a-carousel-viewport");d=a(".thumbnail-container .a-carousel");var w=a("#thumbImage-1"),n=a("#thumbImage-6"),
g=a("#ebooksImageBlock"),f=a("#ebooksImgBlkFront"),l=a("#ebooksImgBlockInlineVideo"),D=a("#ebooksImgBlockInlineVideoSrc"),t=a(".thumbnail-container .a-carousel .a-carousel-card img"),x=6*b.thumbInlineVideos.length,r=n.width()*b.thumbInlineVideos.length;if(d.length&&h.length&&f.length&&l.length&&D.length&&g.length){var q=0,C=0,A=h.width(),z=0,B=g.find("#ebooks-img-canvas"),E=g.find("#ebooks-img-wrapper");B.css("left","0");B.width(E.width());a(e).resize(function(){B.css("left","0");B.width(E.width())});
w.addClass("selected-thumb");h.bind("mouseenter",function(){m.show(500);p.show(500);0<h.scrollLeft()&&m.addClass("enabled");h.scrollLeft()+h.width()<r&&p.addClass("enabled")});t.mouseover(function(c){var g=a(".thumbnail-container .a-carousel-card .selected-thumb"),n=a("#"+c.target.id);if(g.length&&g[0]===c.target)return!1;c=c.target.parentElement.attributes.getNamedItem("aria-posinset");null!==c&&(c=parseInt(c.value),g.removeClass("selected-thumb"),n.addClass("selected-thumb"),f.attr("src",b.thumbImages[c-
1]),l.attr("poster",b.thumbImages[c-1]),l.hide(),f.show(),D.attr("src",b.thumbInlineVideos[c-1]),l.load(),k()?setTimeout(function(){f.hide();l.show()},1E3):(f.hide(),l.show()))});m.bind("click",function(a){a.preventDefault();c()});p.bind("click",function(a){a.preventDefault();v()})}});"use strict";f.when("A","jQuery","Airy","ebookVideoReady","ready").execute(function(d,a,b,c){function v(){p=b.embed({bindings:{play:function(){c.openVideoInFullScreen&&p.enterFullScreen()}},desiredMode:"html",parentId:"ebook-airy-player-container",
streamingUrls:[c.videoSource],swfUrl:c.swfUrl})}function u(){try{p.detach()}catch(a){throw Error(a.message);}p={};setTimeout(function(){v()},100)}function k(b){a.ajax("/kindle-dbs/reftag?ref\x3d"+(c.refTag+b),{method:"get",cache:!1});document.body.style.overflow="hidden";h.removeClass("ebook-video-overlay-hidden");p.play();setTimeout(function(){h.addClass("ebook-overlay-on");w.addClass("ebook-overlay-on");n.addClass("ebook-overlay-on")},10)}function m(){try{p.pause()}catch(a){throw Error(a.message);
}document.body.style.overflow="visible";h.removeClass("ebook-overlay-on");w.removeClass("ebook-overlay-on");n.removeClass("ebook-overlay-on");setTimeout(function(){h.addClass("ebook-video-overlay-hidden");u()},150)}var p,h=a("#ebook-video-overlay"),w=a("#ebook-lightbox"),n=a("#ebook-lightbox-video-close");d=a("#ebooksImageBlock");var g=a("#ebooks-main-image-container");if(!h.length||"undefined"===typeof c)throw Error("Video player not found");v();a("#ebook-video-play").bind("click",function(a){a.preventDefault();
k("_text")});n.bind("click",function(a){a.preventDefault();m()});a("#ebook-lightbox-dark").bind("click",function(){m()});if(d.length){var f=/Edge\/|Trident\/|MSIE /.test(e.navigator.userAgent);c.showVideoPreviewTextOnCoverImageHover&&g.length&&!f&&(g.addClass("ebookPreviewVideo"),g=document.createElement("div"),g.innerHTML=c.watchVideoText,g.setAttribute("class","ebookPreviewVideoText"),document.getElementById("ebooks-main-image-container").appendChild(g),d.bind("click",function(a){a.preventDefault();
k("_img")}))}});"use strict";f.when("A","jQuery","atf").execute(function(d,a){var b=a("#udpKcpAppAdImage");a=a("#udpComiXologyAd");b.length&&d.loadHiResImage(b);a.length&&d.loadHiResImage(a)});"use strict";"use strict";"use strict";f.when("A","jQuery","contentQualityWidgetReady").execute(function(d,a,b){a.ajax("/kindle-dbs/reftag?ref\x3d"+b.onloadReftag,{method:"get",cache:!1});d.on("a:popover:show:kcqPopverPreload",function(){a.ajax("/kindle-dbs/reftag?ref\x3d"+b.hoverOverReftag,{method:"get",cache:!1})})});
"use strict";f.when("A","jQuery","ready","atf").execute(function(d,a){var b=d.state("goodreadsFacebubblesState");b!==t&&d.ajax("/kindle-dbs/external-service/goodreads-facebubbles",{method:"get",params:{profileId:b.goodreadsProfileId,asin:b.asin},success:function(b){a("#goodreads-facebubble").append(b)}})});"use strict";f.when("A","jQuery","atf","a-carousel-framework").execute(function(d,a,b,c){function v(b){a.ajax("/kindle-dbs/reftag?ref_\x3d"+b,{method:"get",data:k})}function u(b,c){b=a(e).scrollTop();
var d=a(e).scrollLeft(),k=d+a(e).width(),n=b+a(e).height(),g=a(c).offset();g.right=g.left+a(c).outerWidth();g.bottom=g.top+a(c).outerHeight();return!(g.right<d||g.left>k||g.top>n||g.bottom<b)}var k={pageType:"featureAwareness",subPageType:"featureAwarenessShoveler",hitType:"dataOnly"};c.onInit("faw-carousel",function(b){function c(n,g){n=a("\x3cimg\x3e");n.load(function(){u(t,g)&&a(g).attr("aria-posinset")==b.getAttr("firstVisibleItem")&&(a(g).find(".fawPrimaryImage").attr("src",a(this).attr("src")),
a(g).addClass("loadedCard"),v(a(g).data("gifTag")))});n.attr("src",a(g).data("gifUrl"))}function k(c,g){u(t,g)&&a(g).attr("aria-posinset")==b.getAttr("firstVisibleItem")||(a(g).find(".fawPrimaryImage").attr("src",a(g).data("imgUrl")),a(g).removeClass("loadedCard"))}function e(){setTimeout(function(){a(".fawCarouselCard").eq(b.getAttr("firstVisibleItem")-1).filter(u).not(".loadedCard").each(c);a(".fawCarouselCard").filter(".loadedCard").each(k)},300)}d.on.afterLoad(e);d.on.scroll(e);d.on("a:carousel:faw-carousel:change:firstVisibleItem",
function(c){c=b.getAttr("totalPages");var g=a("#fawCarousel").width(),d=a(".fawCarouselCard").outerWidth(),g=Math.trunc(g/d),d=a(".faw-carousel-left-button"),k=a(".faw-carousel-right-button");"1"==b.getAttr("firstVisibleItem")?(d.addClass("aok-hidden"),k.removeClass("aok-hidden")):c-(b.getAttr("firstVisibleItem")-1)==g?(d.removeClass("aok-hidden"),k.addClass("aok-hidden")):(d.removeClass("aok-hidden"),k.removeClass("aok-hidden"));e()});a(".fawVideoTrigger").bind("click",function(b){b.preventDefault();
b=a(this).parent(".fawCarouselCard").attr("aria-posinset")-1;a(".faw-modal").css("display","inline");a(".faw-modal").css("visibility","visible");var c=playList[b];a("#fawIframe").attr("src",c);a("#fawIframe").attr("index",b);var c=playList.length,d=b+1+" of "+c;a(".videoIndex").text(d);0==b?(a(".previous-video").css("visibility","hidden"),a(".next-video").css("visibility","visible")):b==c-1?(a(".next-video").css("visibility","hidden"),a(".previous-video").css("visibility","visible")):(a(".previous-video").css("visibility",
"visible"),a(".next-video").css("visibility","visible"));v(a(this).data("refTag"));return!1});a(".previous-video").bind("click",function(b){b=a("#fawIframe").attr("index");1==b?a(".previous-video").css("visibility","hidden"):a(".previous-video").css("visibility","visible");a(".next-video").css("visibility","visible");var c=b+" of "+playList.length;a(".videoIndex").text(c);b=--b;c=playList[b];a("#fawIframe").attr("src",c);a("#fawIframe").attr("index",b);v(refTagList[b])});a(".next-video").bind("click",
function(b){var c=a("#fawIframe").attr("index");c==playList.length-1-1?(a(".previous-video").css("visibility","visible"),a(".next-video").css("visibility","hidden")):(a(".previous-video").css("visibility","visible"),a(".next-video").css("visibility","visible"));b=++c;var d=playList[b];a("#fawIframe").attr("src",d);a("#fawIframe").attr("index",b);c=c+1+" of "+playList.length;a(".videoIndex").text(c);v(refTagList[b])});a(".close-video").bind("click",function(b){a("#fawModal").css("display","none")});
a(".fawCarouselCard").bind("mouseenter",function(b){b.preventDefault();b=a(".loadedCard").parent(".fawCarouselCard");a(".loadedCard").attr("src",a(b).attr("data-img-url"));a(".loadedCard").removeClass("loadedCard");b=a(this).find(".fawPrimaryImage");a(b).attr("src",a(this).attr("data-gif-url"));a(b).addClass("loadedCard")})})});"use strict";f.when("a-carousel-framework","a-carousel-display-fawdisplay").execute(function(d,a){d.registerStrategy("display","fawDisplay",a)});f.when("A","jQuery","a-carousel-constants").register("a-carousel-display-fawdisplay",
function(d,a,b){var c={};c[b.PAGE_SIZE]=1;var e,u;return{initAttrs:c,init:function(a){a.dom.$carousel.children("li").css("visibility","visible");e=a.getAttr(b.SET_SIZE);u=260*e;a.dom.$carousel.width(u);a.updateDimensionsCache({carousel:{width:u},items:d.map(d.range(e),function(){return{width:250,outerWidth:260}})});this.repaint(a)},repaint:function(c){var d=c.getDimensions().viewport.width;c.setAttr(b.PEEK_WIDTH,(d-250)/2,!1);a(".faw-carousel-right-button").css("left",d-15+"px");u<=d?a(".faw-carousel-buttons").css("display",
"none"):a(".faw-carousel-buttons").css("display","inline")},resize:function(a,b){b.viewport&&b.viewport.width!==t&&this.repaint(a)}}});"use strict";f.when("A","ready").execute(function(d){var a=!1,b=d.state("deliverToState");if(b){var c=b.deliverToDropdownName;b.asinRequiresSecureDelivery&&f.when("A","a-alert","a-dropdown").execute(function(a,d,e){var m=d(".ebookBuyboxDrmDeliverToAlert"),f=b.customerDeviceMap,h=!1,w=function(a){var c=a.message;a.actionLinkHref&&a.actionLinkText&&(!b.isTextbook&&b.secureDeliveryInfoWithHeader&&
(c+="\x3cbr\x3e",m.type("info").heading(b.updateRequiredHeader)),c=c+' \x3ca class\x3d"a-link-normal" href\x3d"'+a.actionLinkHref+'"\x3e'+a.actionLinkText+"\x3c/a\x3e");m.html(c).show();ue&&ue.count&&!h&&ue.count("deliverToDRMWarningDisplayCount",1);h=!0};(d=f[b.dropdownDefaultOption].warningMessage)&&w(d);a.on(c,function(c){var d=null;if(c.value in f||b.isTextbook)d=f[c.value].warningMessage;d?w(d):m.hide();a.$(".ebookBuyboxDeliverToDropdown").each(function(a,b){e.getSelect(b).setValue(c.value)})})});
d.on(c,function(c){ue&&ue.count&&!a&&(b.metricName?ue.count(b.metricName,1):ue.count("deliverToSelectionCount",1),b.isTextbook&&ue.count("deliverToSelectionForEtextbookCount",1),a=!0)})}});"use strict";f.when("A","jQuery","ready").register("accordionInstrumentation",function(d,a){var b=e.ue,c,v=function(){this.accordionType="";this.accordionCounterId="ebookAccordion";this.setAccordionCounterId=function(a){this.accordionCounterId=a;this.accordionType||(this.accordionType=a)};this.addRowsToCounterId=
function(a){a=a.replace(/([^\[\],\s]+)/g,'"$\x26"').toLowerCase();if(a=JSON.parse(a)){for(row in a)this.accordionCounterId+="-"+a[row];b&&b.count&&b.count(this.accordionCounterId,0)}};this.accordionSwitch=function(){b&&b.count&&b.count(this.accordionCounterId,1+(b.count(this.accordionCounterId)||0))};this.buttonClick=function(a){var c="ebookUnifiedBuybox";this.accordionType&&(c=this.accordionType);b&&b.count&&b.count(c+"-"+a,b.count(this.accordionCounterId)||0)}};return{counter:function(){c||(c=new v);
return c}}});"use strict";f.when("A","nfcxMessageMetrics").execute(function(d,a){d.on("a:popover:hide:NfcxPopover",function(d){b("Nfcx:message:popup:close:"+a.nfcxWeblabTreatment);c()});d.on("a:popover:show:NfcxPopover",function(d){b("Nfcx:message:popup:open:"+a.nfcxWeblabTreatment);c()});var b=function(a){e.ue&&ue.tag&&(ue.tag(a,"nfcxAlert"),ue.count(a,1))},c=function(){e.ue&&uex("ld","nfcxAlert")}});"use strict";f.when("A").execute(function(d){d.on("a:popover:hide:oneClickInfoPopover",function(c){a("oneClickInfoPopover:popup:close");
b()});d.on("a:popover:show:oneClickInfoPopover",function(c){a("oneClickInfoPopover:popup:open");b()});var a=function(a){e.ue&&ue.tag&&(ue.tag(a,""),ue.count(a,1))},b=function(){e.ue&&uex("ld","oneClickInfoPopover")}});"use strict";f.when("A","ready").execute(function(d){var a=!1,b=d.state("deviceRestrictionPopoverState");if(b){var c=b.metricName;d.on("a:popover:beforeShow:"+b.deviceRestrictionPopoverName,function(b){ue&&ue.count&&!a&&(ue.count(c,(ue.count(c)||0)+1),a=!0)})}if(b=d.state("supportedDevicesPopoverState")){var e=
b.supportedDevicesPopoverName,c=b.metricName;d.on("a:popover:beforeShow:"+e,function(b){ue&&ue.count&&!a&&(ue.count(c,(ue.count(c)||0)+1),a=!0)})}});"use strict";f.when("A","ready").execute(function(d){var a=d.state("deviceRestrictionBottomSheetState"),b=!1;if(a){var c=a.metricName;d.on("a:sheet:afterShow:"+a.deviceRestrictionBottomSheetName,function(a){ue&&ue.count&&!b&&(ue.count(c,(ue.count(c)||0)+1),b=!0)})}});"use strict";f.when("A","jQuery").execute(function(d,a){a(".pointsAwarePriceBlock .loyaltyPointsToolTip").removeAttr("title")});
"use strict";var x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(d){return typeof d}:function(d){return d&&"function"===typeof Symbol&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d};(function(d){d.when("A","jQuery","accordionInstrumentation","ready").execute(function(a,b,c){function d(a,c,e){"mobile"==a?(c.show(),c.removeClass("a-button-focus"),c.addClass("a-button-disabled"),c.find("button").attr("disabled",!0),c.find("button").text(e)):b("#view-cart-button-container").removeClass("aok-hidden")}
function f(a){e.ue&&e.ue.count()&&ue.count(a,1)}a.declarative("add-to-ebooks-cart","click",function(a){var c=a.data.surface,p=a.data.disabledButtonText,h=b("#cart-button-container"),w=b("#add-to-ebooks-cart-spinner"),n=b("#add-to-ebooks-cart-message"),g={asin:a.data.asin,csrf:a.data.csrf,action:"add"},y=b("#deliverTo").find(":selected").val();y!==t&&/^[0-9a-zA-Z]+$/.test(y)&&(g.device={encryptedDeviceAccountId:y});["#add-to-ebooks-cart-violation-message","#add-to-ebooks-cart-success-message","#add-to-ebooks-cart-warning-message",
"#add-to-ebooks-cart-error-message"].forEach(function(a){n.find(a).hide()});var l="#add-to-ebooks-cart-error-message";h.hide();w.removeClass("aok-hidden");b.ajax({url:a.data.url,type:"POST",dataType:"json",data:JSON.stringify(g),contentType:"application/json",headers:{Accept:"application/json"},success:function(a){b("html, body").animate({scrollTop:0},"slow");w.addClass("aok-hidden");if(a.resources&&a.resources.detailedStatus&&a.resources.links){var g=h.find("button");a=a.resources;var k=a.detailedStatus,
r;a:{r=a.links;for(var q=0;q<r.length;q++)if("comics-view-cart"===r[q].rel){r=r[q];break a}r=void 0}r=r.url;q=a.navCartCount;"object"===x(e.navbar)&&"function"===typeof e.navbar.setCartCount&&(q===t||isNaN(Number(q))||e.navbar.setCartCount(q));switch(k){case "ok":case "buyablePriceUnavailable":case "priceIncrease":l="#add-to-ebooks-cart-success-message";d(c,h,p);break;case "duplicateAddition":l="#add-to-ebooks-cart-violation-message";d(c,h,p);break;case "alreadyOwned":l="#add-to-ebooks-cart-violation-message";
h.show();h.removeClass("a-button-focus");h.addClass("a-button-disabled");g.attr("disabled",!0);break;case "limitExceeded":case "unavailable":l="#add-to-ebooks-cart-warning-message","limitExceeded"===k&&n.find("#cart-overflow-sub-instruction").removeClass("aok-hidden"),h.show()}g=n.find(l);k=a.displayMessage.displayString;q=g.find(".cart-message");if("#add-to-ebooks-cart-success-message"===l||"#add-to-ebooks-cart-violation-message"===l){a=a.referenceData.bundle.summary.totalItemCount;var y=a+" "+q.data("item-label");
1<a&&(y=a+" "+q.data("items-label"));k+=" ("+y+")"}"mobile"===c?(b("[id\x3debook-cart-navigation-button]").attr("href",r),b("[id\x3debook-cart-url]").attr("href",r)):b("[id\x3dcomics-basket-view-cart-button]").find("a").attr("href",r);q.text(k);g.show();f(l+"-comics-basket")}else h.show(),n.find(l).show(),f(l+"-comics-basket-from-no-response")},error:function(){b("html, body").animate({scrollTop:0},"slow");w.addClass("aok-hidden");h.show();n.find(l).show();f(l+"-comics-basket-error-no-response")}})})})})(e.P._namespace("ebooksAddToCart"));
"use strict";f.when("A","jQuery","ready").register("inline-buy-utility",function(d,a){function b(b){var d;try{d=b.resources[0].states[0].links[0].url}catch(e){c("BifrostReturnUrl_Failure")}a(location).attr("href",d)}var c=function(a){e.ue&&e.ue.tag&&e.ue.count&&(e.ue.tag(a,"seriesAsinList"),e.ue.count(a+"count",1))},f=function(a){a.addClass("aok-hidden")};return{parentUntilApi:function k(a,b){return 0<a.parent().find(b).length?a:k(a.parent(),b)},greyOutElementApi:function(a){a.css({opacity:.4})},
positionOnApi:function(a,b,c){var d=a.position(),e=d.left,d=d.top;"right"===b?e-=c.outerWidth()-a.outerWidth():"center"===b&&(e-=c.outerWidth()/2-a.outerWidth()/2,d-=c.outerHeight()/2-a.outerHeight()/2);c.css({position:"absolute",zIndex:5E3,top:d,left:e})},callBifrostApi:function(e,m,p,h){e={csrf:m.csrf};"undefined"!==typeof m.device&&"undefined"!==typeof m.device.encryptedId&&(e.device={encryptedDeviceAccountId:m.device.encryptedId});d.ajax(m.actionUrl,{method:"post",contentType:"application/json",
accepts:"application/json",params:e,timeout:5E3,paramsFormat:"json",success:function(d){if("Error"===d.status&&"authentication_failure"===d.errorResult.responseCode)try{var e=d.errorResult.links[0].url+"\x26returnURI\x3d"+document.location.pathname+"\x26returnParams\x3d\x26suppressRememberMe\x3d1";a(location).attr("href",e)}catch(h){c("BifrostSignInUrlFailure")}var g;try{g=d.resources[0].states[0].responseCode}catch(h){c("BifrostResponseCode_Failure")}try{switch(g){case "OK":c("SeriesSubscriptionSuccessful");
var k=a("#series-subscription-success"),l=a("#series-subscribe-widget"),p=a("#itemSpinner_"+m.positionLabel);k.removeClass("aok-hidden");f(p);f(l);k.css({opacity:1});break;case "PAYMENT_VIOLATION":c("SeriesSubscriptionPaymentFixup");b(d);break;default:c("SeriesSubscriptionRedirection"),b(d)}}catch(h){c("SeriesSubscriptionUIBifrostResponseCodeError")}},error:function(b,d,e){c("SeriesSubscriptionUIErrorTemplate");b=a("#series-subscription-error");d=a("#series-subscribe-widget");e=a("#itemSpinner_"+
m.positionLabel);b.removeClass("aok-hidden");f(e);f(d);b.css({opacity:1})}})},bifrostParametersApi:function(a,b,c,d,e,f,g){this.actionUrl=a;this.csrf=b;this.x_client_id=c;this.positionLabel=d;this.asin=e;this.readNowUrl=f;this.actionType=g}}});"use strict";"use strict";f.when("A").execute("ebooks-ContactUsWidget",function(d){var a=d.$,b=function(a){ue&&ue.count&&(ue.tag("ContactUsWidget"),ue.count(a,1))};a("#ebooksContactUs").ready(function(){b("ebooks_contact_us_link_loaded_count")});a("#ebooksContactUsLink").click(function(){b("ebooks_contact_us_link_click_count");
var c=a(this).attr("href");setTimeout(function(){e.location=c},1);return!1})});"use strict";f.when("A","jQuery").register("ku-everywhere-subscribe-utility",function(d,a){return{triggerBottomSheet:function(b){var c=a("#kuBottomSheet"),d=a("#borrow-button-unsubscribed"),f=a("#ku-borrow-spinner");d.hide();f.removeClass("aok-hidden");e.ue&&e.ue.count&&e.ue.count("ku_sign_up_everywhere_bottom_sheet_triggered",1);a.ajax({url:b.url,type:"GET",success:function(a){f.addClass("aok-hidden");d.show();c.html(a);
e.ue&&e.ue.count&&e.ue.count("ku_sign_up_everywhere_bottom_sheet_successfully_rendered",1)},error:function(){e.location=b.fallbackUrl;e.ue&&e.ue.count&&e.ue.count("ku_sign_up_everywhere_bottom_sheet_redirection",1)}})}}});f.when("A","jQuery","ku-everywhere-subscribe-utility").execute("ku-everywhere-subscribe-handler",function(d,a,b){d.declarative("ku-everywhere-subscribe","click",function(a){b.triggerBottomSheet(a.data)});f.now().execute("ku-everywhere-subscribe-on-load-handler",function(b){(b=a("#kuBottomSheet"))&&
b.data("shouldautoload")&&0==b.contents().length&&(a('[id^\x3d"borrow-button-unsubscribed"]').trigger("click"),e.ue&&e.ue.count&&e.ue.count("ku_sign_up_everywhere_bottom_sheet_on_load",1))})});"use strict";"use strict";"use strict";"use strict";"use strict";"use strict";f.when("A","ebooksURLUtil","ready").execute("ebooksDPPageRefreshHelper",function(d,a){d=d.createClass({_dataToBePersisted:{},refreshPage:function(){if(0<Object.keys(this._dataToBePersisted).length){var b=JSON.stringify(this._dataToBePersisted),
c=e.location.href,c=a.removeURLParameter(c,["dataPersistedOnPageRefresh"]),c=a.appendURLParameter(c,{dataPersistedOnPageRefresh:b});e.location.replace(c)}else e.location.reload()},persist:function(a,c){this._dataToBePersisted[a]=c},logMetrics:function(a,c){e.ue&&e.ue.count&&e.ue.count(a,c)},getPersistedData:function(b){var c=a.getQueryStringParameter("dataPersistedOnPageRefresh");try{var d=c?JSON.parse(decodeURIComponent(c))[b]:null;this.logMetrics("DP:eBooks:invalidQueryParameter",0);return d}catch(e){this.logMetrics("DP:eBooks:invalidQueryParameter",
1)}return null}});f.declare("ebooksPageRefreshHelper",new d)});"use strict";f.when("A","ready").register("ebooksURLUtil",function(d){return{appendURLParameter:function(a,b){if(b==t||0==Object.keys(b).length)return a;b=d.$.param(b).replace(/\+/g,"%20");var c=-1==a.indexOf("?")?"?":"\x26";return a+c+b},removeURLParameter:function(a,b){var c=a.split("?");if(2==c.length){var d=c[1].split("\x26");b.forEach(function(a){a+="\x3d";for(var b=d.length-1;0<=b;b--)if(0==d[b].lastIndexOf(a,0)){d.splice(b,1);break}});
a=d.length?c[0]+"?"+d.join("\x26"):c[0]}return a},getQueryStringParameter:function(a){var b=void 0,c=[];b==t&&(b=e.location.href);for(var d=b.slice(b.indexOf("?")+1).split("\x26"),f=0;f<d.length;f++)b=d[f].split("\x3d"),c.push(b[0]),c[b[0]]=b[1];return c[a]},isAbsoluteURL:function(a){return/^https?:\/\//i.test(a)}}})});